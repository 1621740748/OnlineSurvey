(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-f8e55598"],{"03cd":function(t,e,i){!function(e,i){t.exports=i()}(0,(function(){return function(t){function e(s){if(i[s])return i[s].exports;var n=i[s]={i:s,l:!1,exports:{}};return t[s].call(n.exports,n,n.exports,e),n.l=!0,n.exports}var i={};return e.m=t,e.c=i,e.i=function(t){return t},e.d=function(t,i,s){e.o(t,i)||Object.defineProperty(t,i,{configurable:!1,enumerable:!0,get:s})},e.n=function(t){var i=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(i,"a",i),i},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p="",e(e.s=3)}([function(t,e,i){"use strict";function s(){var t=document.documentElement;return"requestFullscreen"in t||"mozRequestFullScreen"in t&&document.mozFullScreenEnabled||"msRequestFullscreen"in t&&document.msFullscreenEnabled||"webkitRequestFullScreen"in t}function n(){return!!(document.fullscreen||document.mozFullScreen||document.fullscreenElement||document.msFullscreenElement||document.webkitIsFullScreen)}function o(t){t.requestFullscreen?t.requestFullscreen():t.webkitRequestFullscreen?t.webkitRequestFullscreen():t.mozRequestFullScreen?t.mozRequestFullScreen():t.msRequestFullscreen?t.msRequestFullscreen():console.log("Fullscreen API is not supported.")}function r(){document.exitFullscreen?document.exitFullscreen():document.webkitExitFullscreen?document.webkitExitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.msExitFullscreen?document.msExitFullscreen():console.log("Fullscreen API is not supported.")}function a(t){document.addEventListener("fullscreenchange",t),document.addEventListener("mozfullscreenchange",t),document.addEventListener("MSFullscreenChange",t),document.addEventListener("webkitfullscreenchange",t)}function l(t){document.removeEventListener("fullscreenchange",t),document.removeEventListener("mozfullscreenchange",t),document.removeEventListener("MSFullscreenChange",t),document.removeEventListener("webkitfullscreenchange",t)}function c(){var t={},e=!1,i=0,s=arguments.length;for("[object Boolean]"===Object.prototype.toString.call(arguments[0])&&(e=arguments[0],i++);i<s;i++){var n=arguments[i];!function(i){for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&(e&&"[object Object]"===Object.prototype.toString.call(i[s])?t[s]=c(!0,t[s],i[s]):t[s]=i[s])}(n)}return t}e.b=s,e.c=n,e.g=o,e.d=r,e.f=a,e.e=l,e.a=c},function(t,e,i){"use strict";function s(){return i.i(a.c)()}function n(t,e,i){c&&(void 0===i?s()?r():o(t,e):i?o(t,e):r())}function o(){function t(){var e=s();e||(i.i(a.e)(t),o.classList.remove(n.fullscreenClass),n.wrap&&(r.parentNode.insertBefore(o,r),r.parentNode.removeChild(r))),n.callback&&n.callback(e)}var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:document.body,n=arguments[1];if(c&&!s()){n=i.i(a.a)(!0,{},l,n);var o=e,r=void 0;n.wrap&&(r=document.createElement("div"),r.style["overflow-y"]="auto",r.style.background=n.background,r.style.width="100%",r.style.height="100%",o.parentNode.insertBefore(r,o),r.appendChild(o),r.addEventListener("click",(function(t){t.target===this&&i.i(a.d)()}))),o.classList.add(n.fullscreenClass),i.i(a.f)(t),i.i(a.g)(n.wrap?r:o)}}function r(){c&&s()&&i.i(a.d)()}var a=i(0),l={wrap:!0,background:"#333",callback:function(){},fullscreenClass:"fullscreen"},c=i.i(a.b)();e.a={getState:s,support:c,toggle:n,enter:o,exit:r}},function(t,e,i){var s=i(5)(i(4),i(6),null,null);t.exports=s.exports},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var s=i(2),n=i.n(s),o=i(1),r=i(0);e.default={install:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},s=e.name||"fullscreen";t.component(s,i.i(r.a)(n.a,{name:s})),t.prototype["$"+s]=o.a}}},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var s=i(0);e.default={props:{background:{type:String,default:"#333"},fullscreenClass:{type:String,default:"fullscreen"},fullscreen:{type:Boolean,default:!1}},data:function(){return{supportFullScreen:!1,isFullscreen:!1}},computed:{wrapperStyle:function(){return{background:this.background,"overflow-y":"auto",width:"100%",height:"100%"}}},methods:{toggle:function(t){void 0===t?i.i(s.c)()?this.exit():this.enter():t?this.enter():this.exit()},enter:function(){this.supportFullScreen&&(i.i(s.f)(this.fullScreenCallback),i.i(s.g)(this.$el))},exit:function(){this.supportFullScreen&&this.getState()&&i.i(s.d)()},getState:function(){return i.i(s.c)()},shadeClick:function(t){t.target===this.$el&&this.exit()},fullScreenCallback:function(){this.isFullscreen=i.i(s.c)(),this.isFullscreen||i.i(s.e)(this.fullScreenCallback),this.$emit("change",this.isFullscreen),this.$emit("update:fullscreen",this.isFullscreen)}},watch:{fullscreen:function(t){t!==i.i(s.c)()&&(t?this.enter():this.exit())}},created:function(){this.supportFullScreen=i.i(s.b)()}}},function(t,e){t.exports=function(t,e,i,s){var n,o=t=t||{},r=typeof t.default;"object"!==r&&"function"!==r||(n=t,o=t.default);var a="function"==typeof o?o.options:o;if(e&&(a.render=e.render,a.staticRenderFns=e.staticRenderFns),i&&(a._scopeId=i),s){var l=Object.create(a.computed||null);Object.keys(s).forEach((function(t){var e=s[t];l[t]=function(){return e}})),a.computed=l}return{esModule:n,exports:o,options:a}}},function(t,e){t.exports={render:function(){var t=this,e=t.$createElement;return(t._self._c||e)("div",{class:t.isFullscreen?[t.fullscreenClass]:[],style:t.isFullscreen?[t.wrapperStyle]:[],on:{click:function(e){return t.shadeClick(e)}}},[t._t("default")],2)},staticRenderFns:[]}}])}))},1500:function(t,e,i){"use strict";i.r(e);var s=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"edit"},[s("fullscreen",{ref:"fullscreen",on:{change:t.fullscreenChange}},[s("div",{ref:"sidebar",staticClass:"edit-sidebar"},[s("a",{directives:[{name:"show",rawName:"v-show",value:t.btnSidebar,expression:"btnSidebar"}],staticClass:"btn_sidebar_switch",on:{click:t.openOrCloseSideBar}},[t._v(" "+t._s(t.btnSideBarName)+" "),s("i",{class:t.btnSideBarIcon})]),s("div",{staticClass:"edit-left-nav"},[s("ul",[s("li",[s("a",{on:{click:function(e){t.toolbarNav=1}}},[s("i",{staticClass:"el-icon-menu",class:{currentNav:1==t.toolbarNav}}),t._v("题型 ")])]),s("li",[s("a",{on:{click:function(e){t.toolbarNav=2}}},[s("i",{staticClass:"el-icon-notebook-2",class:{currentNav:2==t.toolbarNav}}),t._v("题库 ")])]),s("li",[s("a",{on:{click:function(e){t.toolbarNav=3}}},[s("i",{staticClass:"el-icon-document",class:{currentNav:3==t.toolbarNav}}),t._v("大纲 ")])])])]),s("div",{directives:[{name:"show",rawName:"v-show",value:1==t.toolbarNav,expression:"toolbarNav==1"}],staticClass:"edit-left-questbox"},[s("h3",[t._v("基础题型")]),s("div",{staticClass:"content"},[s("el-button",{staticClass:"qs-btn",attrs:{plain:"",size:"medium"},on:{click:function(e){return t.addQuestion("radio")}}},[s("i",{staticClass:"iconfont"},[t._v("")]),t._v("单 选 题 ")]),s("el-button",{staticClass:"qs-btn",attrs:{plain:"",size:"medium"},on:{click:function(e){return t.addQuestion("checkbox")}}},[s("i",{staticClass:"iconfont"},[t._v("")]),t._v("多 选 题 ")]),s("el-button",{staticClass:"qs-btn",attrs:{plain:"",size:"medium"},on:{click:function(e){return t.addQuestion("textarea")}}},[s("i",{staticClass:"iconfont"},[t._v("")]),t._v("文 本 题 ")]),s("el-button",{staticClass:"qs-btn",attrs:{plain:"",size:"medium"},on:{click:function(e){return t.addQuestion("rate")}}},[s("i",{staticClass:"el-icon-star-off",staticStyle:{"margin-right":"6px"}}),t._v("评 分 题 ")])],1)]),s("div",{directives:[{name:"show",rawName:"v-show",value:2==t.toolbarNav,expression:"toolbarNav==2"}],staticClass:"edit-left-questbox"},[s("h3",[t._v("题库")]),s("div",{staticClass:"content"},[s("el-collapse",[s("el-collapse-item",{attrs:{name:"1"}},[s("template",{slot:"title"},[t._v("我的收藏")]),t._l(t.questionBank.user.question_list,(function(e,i){return s("div",{key:i,staticClass:"quest-bank-item",on:{click:function(i){return t.addQuestionOfBank(e)}}},[s("div",{staticStyle:{width:"162px"}},[s("span",{staticClass:"words-ellipsis",staticStyle:{width:"120px"}},[t._v(t._s(e.content.title))]),s("el-popover",{attrs:{placement:"right",width:"200",trigger:"hover","close-delay":0}},[s("div",{staticStyle:{padding:"15px"}},[s("span",{staticStyle:{color:"#333"}},[t._v(t._s(e.content.title))]),s("span",{staticStyle:{color:"#999","margin-left":"10px"}},[t._v("["+t._s(t._f("typeFilter")(e.content.type,t.types))+"]")]),t._l(e.content.options,(function(e,i){return s("div",{key:i},[t._v(t._s(e.value))])}))],2),s("i",{staticClass:"el-icon-info quest-bank-info-btn",attrs:{slot:"reference"},slot:"reference"})]),s("i",{staticClass:"el-icon-error quest-bank-del-btn",on:{click:function(s){return s.stopPropagation(),t.removeQuestionOfBank(e,i)}}})],1)])}))],2),t._l(t.questionBank.system.group_list,(function(e,i,n){return s("el-collapse-item",{key:n,attrs:{name:n}},[s("template",{slot:"title"},[t._v(t._s(i))]),t._l(e,(function(e,i){return s("div",{key:i,staticClass:"quest-bank-item"},t._l(t.questionBank.system.question_list,(function(i,n){return s("div",{key:n,on:{click:function(e){return t.addQuestionOfBank(i)}}},[i.qsItemId===e?s("div",{staticStyle:{width:"160px"}},[s("span",{staticClass:"words-ellipsis",staticStyle:{width:"140px"}},[t._v(t._s(i.content.title))]),s("el-popover",{attrs:{placement:"right",width:"200",trigger:"hover","close-delay":0}},[s("div",{staticStyle:{padding:"15px"}},[s("span",{staticStyle:{color:"#333"}},[t._v(t._s(i.content.title))]),s("span",{staticStyle:{color:"#999","margin-left":"10px"}},[t._v(t._s(t._f("typeFilter")(i.content.type,t.types)))]),t._l(i.content.options,(function(e,i){return s("div",{key:i},[t._v(t._s(e.value))])}))],2),s("i",{staticClass:"el-icon-info quest-bank-info-btn",attrs:{slot:"reference"},slot:"reference"})])],1):t._e()])})),0)}))],2)}))],2)],1)]),s("div",{directives:[{name:"show",rawName:"v-show",value:3==t.toolbarNav,expression:"toolbarNav==3"}],staticClass:"edit-left-questbox"},[s("h3",[t._v("大纲视图")]),s("div",{staticClass:"content"},[s("el-timeline",t._l(t.survey.qsitems,(function(e,i){return s("el-timeline-item",{key:i,attrs:{icon:t._f("iconFilter")(e.type,t.icons),color:"#666",size:"large"}},[s("div",{staticClass:"words-ellipsis",staticStyle:{width:"150px"}},[t._v(t._s(i+1)+". "+t._s(e.title))]),s("template",{slot:"icon"})],2)})),1)],1)])]),s("div",{ref:"contain",staticClass:"edit-contain"},[s("el-button-group",{staticStyle:{right:"35px",position:"fixed"}},[s("el-button",{attrs:{size:"mini",icon:"el-icon-share",plain:""},on:{click:t.share}}),s("el-button",{attrs:{size:"mini",icon:"el-icon-full-screen",plain:""},on:{click:t.toggle}})],1),t.creating?s("el-card",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"survey"},[s("div",{staticClass:"title"},[s("h1",{directives:[{name:"show",rawName:"v-show",value:!t.isEditTitle,expression:"!isEditTitle"}],staticStyle:{"text-align":"center"},on:{click:function(e){return t.editSurveyTitle()}}},[t._v(t._s(t.survey.title))]),s("h1",{directives:[{name:"show",rawName:"v-show",value:t.isEditTitle,expression:"isEditTitle"}]},[s("el-input",{ref:"title",attrs:{maxlength:"20","show-word-limit":"",clearable:!0,placeholder:"请输入标题"},on:{blur:function(e){return t.blurSurveyTitle()}},model:{value:t.survey.title,callback:function(e){t.$set(t.survey,"title",e)},expression:"survey.title"}})],1)]),s("div",{staticClass:"intro"},[s("p",{directives:[{name:"show",rawName:"v-show",value:!t.isEditIntro,expression:"!isEditIntro"}],on:{click:function(e){return t.editSurveyIntro()}}},[t._v(t._s(t.survey.introduction))]),s("p",{directives:[{name:"show",rawName:"v-show",value:t.isEditIntro,expression:"isEditIntro"}]},[s("el-input",{ref:"intro",attrs:{type:"textarea",autosize:{minRows:2,maxRows:2},maxlength:"100","show-word-limit":"",placeholder:"请输入简介"},on:{blur:function(e){return t.blurSurveyIntro()}},model:{value:t.survey.introduction,callback:function(e){t.$set(t.survey,"introduction",e)},expression:"survey.introduction"}})],1)]),s("transition-group",{attrs:{tag:"div"}},t._l(t.survey.qsitems,(function(e,i){return s("div",{directives:[{name:"dragging",rawName:"v-dragging",value:{item:e,list:t.survey.qsitems,group:"quest"},expression:"{ item:item, list:survey.qsitems, group:'quest' }"}],key:i,staticClass:"quest-list",class:{animated:!0,shake:t.editing==i,choose:1==t.isEditQuest[i]},attrs:{draggable:1!=t.isEditQuest[i]},on:{click:function(e){return t.editSurveyQuestion(i)}}},[s("div",{staticClass:"qs-contain"},[s("div",{directives:[{name:"show",rawName:"v-show",value:!t.isEditQuest[i],expression:"!isEditQuest[index]"}]},["radio"===e.type?s("div",[s("p",[t._v(" "+t._s(i+1)+". "+t._s(e.title)+" "),1==e.isRequired?s("span",{staticClass:"must"},[t._v("*")]):t._e()]),s("el-radio-group",{model:{value:t.radioValue,callback:function(e){t.radioValue=e},expression:"radioValue"}},t._l(e.options,(function(e,n){return s("el-radio",{directives:[{name:"show",rawName:"v-show",value:0!=t.survey.qsitems[i].options[n].visibility,expression:"survey.qsitems[index].options[i].visibility != 0"}],key:n,staticClass:"block",attrs:{label:e.id}},[t._v(t._s(e.value))])})),1)],1):"checkbox"===e.type?s("div",[s("p",[t._v(" "+t._s(i+1)+". "+t._s(e.title)+" "),1==e.isRequired?s("span",{staticClass:"must"},[t._v("*")]):t._e()]),s("el-checkbox-group",{model:{value:t.checkboxValue,callback:function(e){t.checkboxValue=e},expression:"checkboxValue"}},t._l(e.options,(function(e,n){return s("el-checkbox",{directives:[{name:"show",rawName:"v-show",value:0!=t.survey.qsitems[i].options[n].visibility,expression:"survey.qsitems[index].options[i].visibility != 0"}],key:n,staticClass:"block",staticStyle:{width:"20px"},attrs:{label:e.id}},[t._v(t._s(e.value))])})),1)],1):"textarea"===e.type?s("div",[s("p",[t._v(" "+t._s(i+1)+". "+t._s(e.title)+" "),1==e.isRequired?s("span",{staticClass:"must"},[t._v("*")]):t._e()]),s("el-input",{attrs:{type:"textarea",autosize:{minRows:5,maxRows:5}}})],1):"rate"===e.type?s("div",[s("p",[t._v(" "+t._s(i+1)+". "+t._s(e.title)+" "),1==e.isRequired?s("span",{staticClass:"must"},[t._v("*")]):t._e()]),s("el-rate")],1):t._e()]),s("div",{directives:[{name:"show",rawName:"v-show",value:!t.isEditQuest[i],expression:"!isEditQuest[index]"}],staticClass:"qs-contain",staticStyle:{"margin-top":"20px"}},[s("el-button",{staticClass:"question-btn",staticStyle:{color:"#E6A23C"},attrs:{size:"mini",plain:"",icon:"el-icon-star-off"},on:{click:function(i){return i.stopPropagation(),t.starQuestion(e)}}},[t._v("收藏")]),s("el-button",{staticClass:"question-btn",attrs:{size:"mini",plain:"",icon:"el-icon-download"},on:{click:function(e){return e.stopPropagation(),t.toBottomQuestion(i)}}},[t._v("最后")]),s("el-button",{staticClass:"question-btn",attrs:{size:"mini",plain:"",icon:"el-icon-upload2"},on:{click:function(e){return e.stopPropagation(),t.toTopQuestion(i)}}},[t._v("最前")]),s("el-button",{staticClass:"question-btn",attrs:{size:"mini",plain:"",icon:"el-icon-bottom"},on:{click:function(e){return e.stopPropagation(),t.swapQuestion(i,i+1)}}},[t._v("下移")]),s("el-button",{staticClass:"question-btn",attrs:{size:"mini",plain:"",icon:"el-icon-top"},on:{click:function(e){return e.stopPropagation(),t.swapQuestion(i,i-1)}}},[t._v("上移")]),s("el-button",{staticClass:"question-btn",staticStyle:{color:"#F56C6C"},attrs:{size:"mini",plain:"",icon:"el-icon-delete"},on:{click:function(e){return e.stopPropagation(),t.delSurveyQuestion(i)}}},[t._v("删除")]),s("el-button",{staticClass:"question-btn",attrs:{size:"mini",plain:"",icon:"el-icon-edit-outline"}},[t._v("编辑")])],1),s("div",{directives:[{name:"show",rawName:"v-show",value:t.isEditQuest[i],expression:"isEditQuest[index]"}]},[s("el-input",{staticClass:"inlineBlock",attrs:{autosize:{minRows:1},"show-word-limit":"",clearable:"",placeholder:"请输入题目"},model:{value:e.title,callback:function(i){t.$set(e,"title",i)},expression:"item.title"}},[s("template",{slot:"prepend"},[t._v(t._s(t._f("typeFilter")(e.type,t.types)))])],2),t._l(e.options,(function(e,n){return s("div",{directives:[{name:"show",rawName:"v-show",value:0!=t.survey.qsitems[i].options[n].visibility,expression:"survey.qsitems[index].options[i].visibility != 0"}],key:n},[s("el-input",{staticClass:"inlineBlock",staticStyle:{width:"82%","margin-right":"1%"},attrs:{clearable:""},model:{value:e.value,callback:function(i){t.$set(e,"value",i)},expression:"option.value"}},[s("template",{slot:"prepend"},[t._v("选项")])],2),s("div",{staticClass:"toolbar",staticStyle:{float:"right"}},[s("el-button",{attrs:{icon:"el-icon-plus",circle:""},on:{click:function(e){return t.addOption(i,n)}}}),s("el-button",{attrs:{icon:"el-icon-minus",circle:""},on:{click:function(e){return t.delOption(i,n)}}})],1)],1)})),"radio"===e.type||"checkbox"===e.type?s("div",{staticStyle:{display:"inline-block"}},[s("el-button",{staticClass:"inlineBlock",staticStyle:{cursor:"pointer"},on:{click:function(e){return t.addOption(i)}}},[t._v("添加选项")]),s("el-button",{staticClass:"inlineBlock",staticStyle:{cursor:"pointer"},on:{click:function(e){return t.addOtherOption(i)}}},[t._v("添加「其他」项")])],1):t._e(),s("el-switch",{staticClass:"inlineBlock",staticStyle:{float:"right",margin:"15px 0px"},attrs:{"active-value":1,"inactive-value":0,"inactive-text":"此题必填"},model:{value:e.isRequired,callback:function(i){t.$set(e,"isRequired",i)},expression:"item.isRequired"}}),s("el-button",{staticClass:"inlineBlock",staticStyle:{width:"100%",cursor:"pointer"},attrs:{type:"primary"},on:{click:function(e){return e.stopPropagation(),t.saveSurveyQuestion(i)}}},[t._v("完 成 编 辑")])],2)])])})),0)],1):t._e()],1)]),s("el-dialog",{staticStyle:{"font-weight":"bold"},attrs:{title:"请选择问卷创建类型",width:"730px",modal:!1,visible:t.createDialogVisible,"close-on-click-modal":!1,"close-on-press-escape":!1,"show-close":!1,"append-to-body":""},on:{"update:visible":function(e){t.createDialogVisible=e}}},[s("div",[s("el-row",[s("el-col",{attrs:{span:8}},[s("div",{staticClass:"grid-content",class:{isChoose:0==t.chooseType},on:{click:function(e){t.chooseType=0}}},[s("el-card",{staticClass:"item blank",attrs:{shadow:"hover"}},[s("img",{attrs:{src:i("c6b68")}}),s("p",[t._v("创建空白问卷")]),s("p",[t._v("从一份空白问卷开始创建")])])],1)]),s("el-col",{attrs:{span:8}},[s("div",{staticClass:"grid-content",class:{isChoose:1==t.chooseType},on:{click:function(e){t.chooseType=1}}},[s("el-card",{staticClass:"item template",attrs:{shadow:"hover"}},[s("img",{attrs:{src:i("60e1")}}),s("p",[t._v("选择问卷模板")]),s("p",[t._v("使用其他用户公开的问卷")])])],1)])],1)],1),s("div",{attrs:{slot:"footer"},slot:"footer"},[s("el-button",{on:{click:function(e){return t.cancelCreate()}}},[t._v("取消")]),s("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.createSurvey()}}},[s("span",{directives:[{name:"show",rawName:"v-show",value:0==t.chooseType,expression:"chooseType == 0"}]},[t._v("立即创建")]),s("span",{directives:[{name:"show",rawName:"v-show",value:1==t.chooseType,expression:"chooseType == 1"}]},[t._v("下一步")])])],1)]),s("el-dialog",{staticStyle:{"font-weight":"bold"},attrs:{title:"设置问卷标签",width:"580px",visible:t.tagDialogVisible,"close-on-click-modal":!1,"close-on-press-escape":!1,"show-close":!1,"append-to-body":""},on:{"update:visible":function(e){t.tagDialogVisible=e}}},[s("div",{staticStyle:{width:"100%"}},[t._l(t.tags,(function(e,i){return s("el-tag",{key:i,attrs:{type:"info",closable:"","disable-transitions":!1},on:{close:function(e){return t.deleteTag(i)}}},[t._v(t._s(e.tagName))])})),t.tagInputVisible?s("el-input",{ref:"saveTagInput",staticClass:"input-new-tag",attrs:{size:"small"},on:{blur:t.addTag},nativeOn:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.addTag(e)}},model:{value:t.tagInputValue,callback:function(e){t.tagInputValue=e},expression:"tagInputValue"}}):s("el-button",{staticClass:"button-new-tag",attrs:{size:"small"},on:{click:t.showTagInput}},[t._v("+ 添加新标签")])],2),s("div",{attrs:{slot:"footer"},slot:"footer"},[s("el-button",{attrs:{type:"primary"},on:{click:function(e){t.tagDialogVisible=!1}}},[t._v("关闭")])],1)])],1)},n=[],o=(i("4160"),i("a434"),i("159b"),i("5530")),r=i("2f62"),a=i("4328"),l=i.n(a),c=i("03cd"),u=i.n(c),d=i("2b0e");d["default"].use(u.a);var v={data:function(){return{surveyId:"",createDialogVisible:!1,tagDialogVisible:!1,creating:!1,chooseType:0,questionBank:{system:{},user:{}},isOpenSideBar:!0,btnSidebar:!0,btnSideBarName:"收起工具栏",btnSideBarIcon:"el-icon-s-fold",toolbarNav:1,survey:{},radioValue:"",checkboxValue:[],loading:!0,fullscreen:!1,tags:[],tagInputVisible:!1,tagInputValue:"",isEditTitle:!1,isEditIntro:!1,isEditQuest:[],editing:null,oldVal:"",oldObj:{},icons:[{value:"radio",text:"iconfont icon-danxuan"},{value:"checkbox",text:"iconfont icon-duoxuan"},{value:"textarea",text:"iconfont icon-duohangwenben"},{value:"rate",text:"el-icon-star-off"}],types:[{value:"radio",text:"单选题"},{value:"checkbox",text:"多选题"},{value:"textarea",text:"文本题"},{value:"rate",text:"评分题"}],preQsitems:[]}},filters:{iconFilter:function(t,e){for(var i=0;i<e.length;i++)if(t==e[i].value)return e[i].text},typeFilter:function(t,e){for(var i=0;i<e.length;i++)if(t==e[i].value)return e[i].text}},methods:{cancelCreate:function(){this.createDialogVisible=!1,this.$router.go(-1)},createSurvey:function(){var t=this;if(0==this.chooseType){this.createDialogVisible=!1,this.creating=!0;var e={};e.creator=this.uid,this.$http.post("survey/new/blank",e).then((function(e){t.$router.push({query:{surveyId:e.data}}),t.$router.go(0)}))}else 1==this.chooseType&&this.$router.push("/home/template")},openOrCloseSideBar:function(){this.isOpenSideBar?(this.isOpenSideBar=!1,this.btnSideBarName="展开工具栏",this.btnSideBarIcon="el-icon-s-unfold",this.$refs.sidebar.style="left: -251px",this.$refs.contain.style="left: 0px"):(this.isOpenSideBar=!0,this.btnSideBarName="收起工具栏",this.btnSideBarIcon="el-icon-s-fold",this.$refs.sidebar.style="left: 0px",this.$refs.contain.style="left: 251px")},getSurvey:function(){var t=this;this.$http.get("survey/"+this.surveyId).then((function(e){t.loading=!1,t.survey=e.data;var i=e.data.qsitems;for(var s in i)t.$set(t.isEditQuest,s,!1)})).catch((function(){t.loading=!1}))},addQuestion:function(t,e){var i=this;for(var s in this.isEditQuest)if(1==this.isEditQuest[s])return this.editing=s,void setTimeout((function(){i.editing=null}),1e3);var n={};n.type=t,n.isRequired=0,n.surveyId=this.survey.id;var o=this.survey.qsitems.length;if(n.number=o+1,o>0){var r=this.survey.qsitems[o-1].orderId;n.orderId=r+1}else n.orderId=1e3;if(null==e)switch(t){case"radio":n.title="这是一道单选题",n.options=[{value:"选项A",orderId:0,visibility:1},{value:"选项B",orderId:1,visibility:1}];break;case"checkbox":n.title="这是一道多选题",n.options=[{value:"选项A",orderId:0,visibility:1},{value:"选项B",orderId:1,visibility:1}];break;case"textarea":n.title="这是一道文本题";break;case"rate":n.title="这是一道评分题";break;default:break}else n.title=e.title,n.options=e.options;this.$http.saveSurvey("question/new",n).then((function(){i.survey.qsitems.push(n),i.$nextTick((function(){i.$refs.contain.scrollTop=i.$refs.contain.scrollHeight,i.getSurvey()}))}))},delSurveyQuestion:function(t){var e=this,i="确定要将此题目彻底删除吗？";this.$confirm(i,"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){var i={};i.id=e.survey.qsitems[t].id,i.type=e.survey.qsitems[t].type,i.qsItemId=e.survey.qsitems[t].qsItemId,i.surveyId=e.survey.id;var s=e.survey.qsitems.length-1;i.number=s,e.$http.saveSurvey("question/del",i).then((function(){e.survey.qsitems.splice(t,1)}))}))},editSurveyQuestion:function(t){var e=this;for(var i in this.isEditQuest)if(1==this.isEditQuest[i]){if(i==t)return;if(i!=t)return this.editing=i,void setTimeout((function(){e.editing=null}),1e3)}this.$set(this.isEditQuest,t,!0);var s=this.survey.qsitems;for(var n in s)n==t&&(this.oldObj=JSON.parse(JSON.stringify(this.survey.qsitems[n])))},saveSurveyQuestion:function(t){var e=!1,i=this.oldObj,s=this.survey.qsitems;for(var n in s)if(n==t){var o=s[n].title,r=s[n].options,a=s[n].isRequired,l={};if(l.type=s[n].type,l.surveyId=this.survey.id,o!=i.title&&(e=!0,l.qsItemId=s[n].qsItemId,l.title=s[n].title),null!=r)if(r.length!=i.options.length){for(var c in e=!0,r)r[c].orderId=c;l.options=r}else if(r.length==i.options.length)for(var u in r)r[u].value==i.options[u].value&&r[u].visibility==i.options[u].visibility||(e=!0,l.options=r);a!=i.isRequired&&(e=!0,l.id=s[n].id,l.isRequired=s[n].isRequired),e&&this.$http.saveSurvey("question/save",l)}this.$set(this.isEditQuest,t,!1)},editSurveyTitle:function(){var t=this;this.isEditTitle=!0,this.$nextTick((function(){t.$refs["title"].focus()})),this.oldVal=this.survey.title},blurSurveyTitle:function(){var t={};0!=this.survey.title.length?(this.survey.title!==this.oldVal&&(t.id=this.survey.id,t.title=this.survey.title,this.$http.saveSurvey("save/survey/info",t)),this.isEditTitle=!1):alert()},editSurveyIntro:function(){var t=this;this.isEditIntro=!0,this.$nextTick((function(){t.$refs["intro"].focus()})),this.oldVal=this.survey.introduction},blurSurveyIntro:function(){this.isEditIntro=!1;var t={};this.survey.introduction!==this.oldVal&&(t.id=this.survey.id,t.introduction=this.survey.introduction,this.$http.saveSurvey("save/survey/info",t))},addOption:function(t,e){var i=this.survey.qsitems[t];null==e?e=0:e++,i.options.splice(e,0,{value:"",qsItemId:i.qsItemId,visibility:1})},delOption:function(t,e){var i=this.survey.qsitems[t];null!=i.options[e].id?i.options[e].visibility=0:i.options.splice(e,1)},addOtherOption:function(t){var e=this.survey.qsitems[t],i=e.options.length;e.options.splice(i,0,{value:"其他 ____",qsItemId:e.qsItemId,visibility:1})},toggle:function(){this.btnSidebar=!1,this.$refs["sidebar"].style="top:0",this.$refs["contain"].style="top:0",this.$refs["fullscreen"].toggle()},fullscreenChange:function(t){this.fullscreen=t,0==this.fullscreen&&(this.btnSidebar=!0,this.$refs["sidebar"].style="top:122px",this.$refs["contain"].style="top:122px")},starQuestion:function(t){var e=this,i={};i.belongId=this.uid,i.qsItemId=t.qsItemId,i.type=t.type;var s="";this.$http.post("star_question",i).then((function(i){e.$message({message:'<strong style="color:#333">收藏成功</strong>',dangerouslyUseHTMLString:!0,iconClass:" ",center:!0,duration:1e3,offset:68,customClass:"center-msgbox"}),s=i.data,e.questionBank.user.question_list.unshift({qsItemId:s,content:{title:t.title,type:t.type,options:t.options}})}))},addQuestionOfBank:function(t){var e={};e.title=t.content.title,e.options=t.content.options,this.addQuestion(t.content.type,e)},removeQuestionOfBank:function(t,e){var i=this;this.$confirm("确认要删除这道题目吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消"}).then((function(){var s={};s.type=t.content.type,s.qsItemId=t.qsItemId,i.$http.post("remove_star_question",l.a.stringify(s)).then((function(){var t=i.questionBank.user.question_list;t.splice(e,1)}))}))},getQuestionBank:function(){var t=this;this.$http.post("question_system_list_get").then((function(e){t.questionBank.system=e.data})),this.$http.post("question_user_list_get/".concat(this.uid)).then((function(e){t.questionBank.user=e.data}))},swapQuestion:function(t,e){var i=this,s=this.survey.qsitems,n=s[t],o=s[e];if(e<0)this.$message({message:"已经到顶了！",type:"error"});else if(e>s.length-1)this.$message({message:"已经到底了！",type:"error"});else{var r={};r.fromId=n.id,r.fromOid=n.orderId,r.toId=o.id,r.toOid=o.orderId,this.$http.saveSurvey("question/swap",l.a.stringify(r)).then((function(){i.getSurvey()}))}},toTopQuestion:function(t){var e=this,i=this.survey.qsitems;if(0!=t){var s={};s.id=i[t].id,s.orderId=i[0].orderId-1,this.$http.saveSurvey("question/jump",l.a.stringify(s)).then((function(){e.getSurvey(),e.$refs.contain.scrollTop=0}))}else this.$message({message:"已经到顶了！",type:"error"})},toBottomQuestion:function(t){var e=this,i=this.survey.qsitems;if(t!=this.survey.qsitems.length-1){var s={};s.id=i[t].id,s.orderId=i[i.length-1].orderId+1,this.$http.saveSurvey("question/jump",l.a.stringify(s)).then((function(){e.getSurvey(),e.$refs.contain.scrollTop=e.$refs.contain.scrollHeight}))}else this.$message({message:"已经到底了！",type:"error"})},share:function(){var t=this;this.tagDialogVisible=!0;var e={};e.surveyId=this.surveyId,this.$http.post("/tag/tags",l.a.stringify(e)).then((function(e){t.tags=e.data}))},deleteTag:function(t){var e=this,i={};i.id=this.tags[t].id,this.$http.post("/tag/del",l.a.stringify(i)).then((function(){e.tags.splice(t,1)}))},showTagInput:function(){var t=this;this.tagInputVisible=!0,this.$nextTick((function(){t.$refs.saveTagInput.$refs.input.focus()}))},addTag:function(){var t=this;if(this.tagInputValue){var e={};e.tagName=this.tagInputValue,e.surveyId=this.surveyId,this.$http.post("/tag/add",e).then((function(){t.tags.push(e)})).catch((function(){t.$message({message:"添加失败",type:"error"})}))}this.tagInputVisible=!1,this.tagInputValue=""}},computed:Object(o["a"])({},Object(r["c"])({uid:function(t){return t.uid}})),mounted:function(){var t=this;this.surveyId=this.$route.query.surveyId,null==this.surveyId?this.createDialogVisible=!0:(this.creating=!0,this.getSurvey(),this.getQuestionBank()),this.$dragging.$on("dragged",(function(){t.preQsitems=JSON.parse(JSON.stringify(t.survey.qsitems))})),this.$dragging.$on("dragend",(function(){var e=JSON.stringify(t.preQsitems)===JSON.stringify(t.survey.qsitems);if(e){var i=[];t.survey.qsitems.forEach((function(t){var e={};e.id=t.id,e.orderId=t.orderId,i.push(e)})),t.$http.saveSurvey("/question/reorder",i)}t.preQsitems=[]}))},beforeRouteLeave:function(t,e,i){for(var s in this.isEditQuest)if(1==this.isEditQuest[s]){var n=window.confirm("系统可能不会保存您所做的更改。");if(!n)return void i(!1);i()}i()}},p=v,f=(i("5f11"),i("d45a"),i("2877")),h=Object(f["a"])(p,s,n,!1,null,"bf5feafc",null);e["default"]=h.exports},"55c5":function(t,e,i){},"5f11":function(t,e,i){"use strict";i("5f98")},"5f98":function(t,e,i){},"60e1":function(t,e,i){t.exports=i.p+"img/template.e6654530.png"},a434:function(t,e,i){"use strict";var s=i("23e7"),n=i("23cb"),o=i("a691"),r=i("50c4"),a=i("7b0b"),l=i("65f0"),c=i("8418"),u=i("1dde"),d=i("ae40"),v=u("splice"),p=d("splice",{ACCESSORS:!0,0:0,1:2}),f=Math.max,h=Math.min,m=9007199254740991,y="Maximum allowed length exceeded";s({target:"Array",proto:!0,forced:!v||!p},{splice:function(t,e){var i,s,u,d,v,p,g=a(this),b=r(g.length),k=n(t,b),_=arguments.length;if(0===_?i=s=0:1===_?(i=0,s=b-k):(i=_-2,s=h(f(o(e),0),b-k)),b+i-s>m)throw TypeError(y);for(u=l(g,s),d=0;d<s;d++)v=k+d,v in g&&c(u,d,g[v]);if(u.length=s,i<s){for(d=k;d<b-s;d++)v=d+s,p=d+i,v in g?g[p]=g[v]:delete g[p];for(d=b;d>b-s+i;d--)delete g[d-1]}else if(i>s)for(d=b-s;d>k;d--)v=d+s-1,p=d+i-1,v in g?g[p]=g[v]:delete g[p];for(d=0;d<i;d++)g[d+k]=arguments[d+2];return g.length=b-s+i,u}})},c6b68:function(t,e,i){t.exports=i.p+"img/blank.ac4e57a8.png"},d45a:function(t,e,i){"use strict";i("55c5")}}]);
//# sourceMappingURL=chunk-f8e55598.9fab30dd.js.map