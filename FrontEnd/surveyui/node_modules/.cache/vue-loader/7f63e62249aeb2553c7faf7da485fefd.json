{"remainingRequest":"/data/OnlineSurvey/FrontEnd/surveyui/node_modules/vue-loader/lib/index.js??vue-loader-options!/data/OnlineSurvey/FrontEnd/surveyui/src/views/home/Search.vue?vue&type=style&index=0&id=1fd47063&scoped=true&lang=css&","dependencies":[{"path":"/data/OnlineSurvey/FrontEnd/surveyui/src/views/home/Search.vue","mtime":1605753490110},{"path":"/data/OnlineSurvey/FrontEnd/surveyui/node_modules/css-loader/dist/cjs.js","mtime":499162500000},{"path":"/data/OnlineSurvey/FrontEnd/surveyui/node_modules/vue-loader/lib/loaders/stylePostLoader.js","mtime":499162500000},{"path":"/data/OnlineSurvey/FrontEnd/surveyui/node_modules/postcss-loader/src/index.js","mtime":499162500000},{"path":"/data/OnlineSurvey/FrontEnd/surveyui/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/data/OnlineSurvey/FrontEnd/surveyui/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKDQouc2VhcmNoIHsNCiAgcG9zaXRpb246IGZpeGVkOw0KICB0b3A6IDYwcHg7DQogIGxlZnQ6IDBweDsNCiAgYm90dG9tOiAwcHg7DQogIHJpZ2h0OiAwcHg7DQogIHdpZHRoOiAxMDAlOw0KICBoZWlnaHQ6IGNhbGMoMTAwJS02MHB4KTsNCiAgb3ZlcmZsb3cteTogc2Nyb2xsOw0KfQ0KLyog5p+l6K+i57G75Z6L6I+c5Y2VIHN0YXJ0ICovDQoubWVudSB7DQogIGhlaWdodDogMTIwcHg7DQp9DQoubWVudSB1bCB7DQogIGJvcmRlci1yaWdodDogbm9uZTsNCn0NCi5tZW51IHVsIGxpIHsNCiAgYm9yZGVyOiAxcHggc29saWQgI2VlZTsNCn0NCi8qIC5tZW51IHVsIGxpOm50aC1jaGlsZCgxKSB7DQogIGJvcmRlci1ib3R0b206IG5vbmU7DQp9DQoubWVudSB1bCBsaTpudGgtY2hpbGQoMikgew0KICBib3JkZXItYm90dG9tOiBub25lOw0KfSAqLw0KLm1lbnUgdWwgbGkgYSB7DQogIGNvbG9yOiAjMDM2NmQ2Ow0KfQ0KLm1lbnUgLmVsLXRhZyB7DQogIGJvcmRlci1yYWRpdXM6IDEwcHg7DQp9DQouY3VycmVudE5hdiB7DQogIGJvcmRlci1sZWZ0OiAycHggc29saWQgI2UzNjIwOSAhaW1wb3J0YW50Ow0KfQ0KLyog5p+l6K+i57G75Z6L6I+c5Y2VIGVuZCAqLw0KLyog5p+l6K+i57uT5p6c5YaF5a65IHN0YXJ0ICovDQoucmVzdWx0LWNvbnRhaW4gew0KICBwYWRkaW5nLWJvdHRvbTogNjBweDsNCn0NCi5kZXRhaWwgaDMgew0KICBjb2xvcjogIzI0MjkyZTsNCiAgaGVpZ2h0OiA0MHB4Ow0KICBsaW5lLWhlaWdodDogNDBweDsNCiAgbWFyZ2luLXRvcDogMDsNCn0NCi5kZXRhaWwgLmVsLXNlbGVjdCB7DQogIGZsb2F0OiByaWdodDsNCiAgd2lkdGg6IDE1MHB4Ow0KfQ0KLnBhZ2luYXRpb24gew0KICB0ZXh0LWFsaWduOiBjZW50ZXI7DQogIG1hcmdpbjogMTBweCAwOw0KfQ0KLyog5p+l6K+i57uT5p6c5YaF5a65IHN0YXJ0ICovDQovKiDmn6Xor6LmnaHnm64gc3RhcnQgKi8NCi5zZWFyY2gtcmVzdWx0LWl0ZW0gew0KICBwYWRkaW5nOiAyNHB4IDA7DQogIGJvcmRlci10b3A6IDFweCBzb2xpZCAjZTFlNGU4Ow0KfQ0KLnNlYXJjaC1yZXN1bHQtaXRlbSAuaXRlbS1pY29uIHsNCiAgbWFyZ2luLXRvcDogMnB4Ow0KICBtYXJnaW4tcmlnaHQ6IDEwcHg7DQogIGZsb2F0OiBsZWZ0Ow0KfQ0KLnNlYXJjaC1yZXN1bHQtaXRlbSAuaXRlbS10ZXh0IHsNCiAgZGlzcGxheTogaW5saW5lLWJsb2NrOw0KICB3aWR0aDogNjc1cHg7DQp9DQouc2VhcmNoLXJlc3VsdC1pdGVtIC50aXRsZSBhIHsNCiAgY29sb3I6ICMwMzY2ZDY7DQogIGZvbnQtc2l6ZTogMTZweDsNCn0NCi5lbC1saW5rLmlzLXVuZGVybGluZTpob3ZlcjphZnRlciB7DQogIGJvcmRlci1ib3R0b206IDJweCBzb2xpZCAjMDM2NmQ2Ow0KfQ0KLnNlYXJjaC1yZXN1bHQtaXRlbSAuaW50cm8gcCB7DQogIG1hcmdpbjogNnB4IDAgMnB4IDA7DQogIGZvbnQtc2l6ZTogMTRweDsNCn0NCi5zZWFyY2gtcmVzdWx0LWl0ZW0gLnRhZ3Mgew0KICBtYXJnaW46IDZweCAwIDhweCAwOw0KfQ0KLnNlYXJjaC1yZXN1bHQtaXRlbSAudGFncyBzcGFuIHsNCiAgbWFyZ2luLXJpZ2h0OiA1cHg7DQp9DQouc2VhcmNoLXJlc3VsdC1pdGVtIC5pbmZvIGEgew0KICBtYXJnaW4tcmlnaHQ6IDE2cHg7DQp9DQouc2VhcmNoLXJlc3VsdC1pdGVtIC5pbmZvIC51cGRhdGUtZGF0ZSB7DQogIGNvbG9yOiAjNjA2MjY2Ow0KICBmb250LXNpemU6IDE0cHg7DQp9DQovKiDmn6Xor6LmnaHnm64gZW5kICovDQovKiDmu5rliqjmnaHmoLflvI8gc3RhcnQgKi8NCi5zZWFyY2g6Oi13ZWJraXQtc2Nyb2xsYmFyIHsNCiAgd2lkdGg6IDEwcHg7DQp9DQouc2VhcmNoOjotd2Via2l0LXNjcm9sbGJhci10aHVtYiB7DQogIGJhY2tncm91bmQtY29sb3I6IHJnYmEoMCwgMCwgMCwgMC4xNSk7DQogIGJvcmRlci1yYWRpdXM6IDVweDsNCn0NCi5zZWFyY2g6Oi13ZWJraXQtc2Nyb2xsYmFyLXRodW1iOmhvdmVyIHsNCiAgYmFja2dyb3VuZC1jb2xvcjogcmdiYSgwLCAwLCAwLCAwLjIpOw0KfQ0KLyog5rua5Yqo5p2h5qC35byPIGVuZCAqLw0K"},{"version":3,"sources":["Search.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAoPA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"Search.vue","sourceRoot":"src/views/home","sourcesContent":["<template>\r\n  <div class=\"search\" ref=\"search\">\r\n    <div style=\"width:950px; margin:25px auto;\">\r\n      <el-row :gutter=\"30\">\r\n        <el-col :span=\"6\">\r\n          <div class=\"menu\">\r\n            <el-menu>\r\n              <el-menu-item :class=\"{currentNav:searchType==1}\" @click=\"chooseSearchType(1)\">\r\n                <el-link :underline=\"false\">问卷</el-link>\r\n                <el-link :underline=\"false\" style=\"float:right\">\r\n                  <el-tag size=\"mini\" type=\"info\" effect=\"dark\">{{searchCounts.survey}}</el-tag>\r\n                </el-link>\r\n              </el-menu-item>\r\n              <!-- <el-menu-item :class=\"{currentNav:searchType==2}\" @click=\"chooseSearchType(2)\">\r\n                <el-link :underline=\"false\">题目</el-link>\r\n                <el-link :underline=\"false\" style=\"float:right\">\r\n                  <el-tag size=\"mini\" type=\"info\" effect=\"dark\">{{searchCounts.quest}}</el-tag>\r\n                </el-link>\r\n              </el-menu-item>\r\n              <el-menu-item :class=\"{currentNav:searchType==3}\" @click=\"chooseSearchType(3)\">\r\n                <el-link :underline=\"false\">标签</el-link>\r\n                <el-link :underline=\"false\" style=\"float:right\">\r\n                  <el-tag size=\"mini\" type=\"info\" effect=\"dark\">{{searchCounts.tag}}</el-tag>\r\n                </el-link>\r\n              </el-menu-item> -->\r\n            </el-menu>\r\n          </div>\r\n        </el-col>\r\n        <el-col :span=\"18\">\r\n          <div class=\"result-contain\">\r\n            <div class=\"detail\">\r\n              <h3>\r\n                <span v-if=\"searchType == '1'\">{{searchCounts.survey}}个问卷结果</span>\r\n                <span v-if=\"searchType == '2'\">{{searchCounts.quest}}个题目结果</span>\r\n                <span v-if=\"searchType == '3'\">{{searchCounts.tag}}个标签结果</span>\r\n                <el-select v-model=\"sortby\" placeholder=\"请选择\" @change=\"selectSortBy()\">\r\n                  <el-option-group label=\"选择排序条件\">\r\n                    <el-option value=\"1\" label=\"最近修改\"></el-option>\r\n                    <el-option value=\"2\" label=\"最多使用\"></el-option>\r\n                    <el-option value=\"3\" label=\"最多浏览\"></el-option>\r\n                  </el-option-group>\r\n                </el-select>\r\n              </h3>\r\n            </div>\r\n            <!-- 检索结果为0显示 -->\r\n            <div class=\"search-result-item\" v-if=\"search.length==0\">\r\n              <div style=\"width:400px;margin:50px auto;text-align:center;\">\r\n                <i class=\"el-icon-search\" style=\"font-size:30px;\"></i>\r\n                <h3 style=\"color:#24292E;margin:10px 0;\">我们未找到任何与 “{{searchText}}” 匹配的结果</h3>\r\n                <p style=\"color:#4f4f4f;font-size:12px;\">要不您换个关键字？</p>\r\n              </div>\r\n            </div>\r\n            <!-- 问卷检索结果显示 -->\r\n            <div v-if=\"searchType == '1'\">\r\n              <div class=\"search-result-item\" v-for=\"(item, index) in search\" :key=\"index\">\r\n                <div class=\"item-icon\">\r\n                  <i class=\"icon el-icon-collection\"></i>\r\n                </div>\r\n                <div class=\"item-text\">\r\n                  <div class=\"title\">\r\n                    <el-link\r\n                      @click=\"preview(item.id)\"\r\n                      v-html=\"item.title.replace(new RegExp(searchText, 'gm'), `<strong>${searchText}</strong>`)\"\r\n                    >{{item.title}}</el-link>\r\n                  </div>\r\n                  <div class=\"intro\" v-if=\"item.introduction\">\r\n                    <p\r\n                      v-html=\"item.introduction.replace(new RegExp(searchText, 'gm'), `<strong>${searchText}</strong>`)\"\r\n                    >{{item.introduction}}</p>\r\n                  </div>\r\n                  <div class=\"tags\" v-if=\"item.tags\">\r\n                    <el-tag size=\"mini\" v-for=\"(tag, index) in item.tags\" :key=\"index\">{{tag}}</el-tag>\r\n                  </div>\r\n                  <div class=\"info\">\r\n                    <el-tooltip content=\"使用数\" placement=\"bottom\" effect=\"light\">\r\n                      <el-link :underline=\"false\">\r\n                        <i class=\"el-icon-user-solid\"></i>\r\n                        {{item.quote}}\r\n                      </el-link>\r\n                    </el-tooltip>\r\n                    <el-tooltip content=\"回收数\" placement=\"bottom\" effect=\"light\">\r\n                      <el-link :underline=\"false\">\r\n                        <i class=\"el-icon-document-checked\"></i>\r\n                        {{item.recycleCount}}\r\n                      </el-link>\r\n                    </el-tooltip>\r\n                    <el-tooltip content=\"浏览数\" placement=\"bottom\" effect=\"light\">\r\n                      <el-link :underline=\"false\">\r\n                        <i class=\"el-icon-view\"></i>\r\n                        {{item.visits}}\r\n                      </el-link>\r\n                    </el-tooltip>\r\n                    <span\r\n                      class=\"update-date\"\r\n                    >修改于 {{new Date().getDateDiff(new Date(item.updateDate))}}</span>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n            <!-- 问卷检索结果显示 -->\r\n            <div v-if=\"searchType == '2'\">\r\n              <div class=\"search-result-item\" v-for=\"(item, index) in 10\" :key=\"index\">\r\n                <div style=\"font-size:14px\">\r\n                <p>[单选题] 这是一道单选题单选题单选题。</p>\r\n                <span v-for=\"(item, index) in 4\" :key=\"index\">大苏打 / </span><span>...</span>\r\n                </div>\r\n                <span  style=\"float:right;font-size:14px;line-height:19.2px\">《<el-link :underline=\"true\" type=\"primary\">问卷标题</el-link>》</span>\r\n              </div>\r\n            </div>\r\n            <div class=\"pagination\">\r\n              <el-pagination\r\n                background\r\n                layout=\"prev, pager, next\"\r\n                :page-size=\"pageinfo.pageSize\"\r\n                :current-page=\"Number($route.query.page)\"\r\n                :total=\"pageinfo.total\"\r\n                @current-change=\"searchCurrentChange\"\r\n                hide-on-single-page\r\n              ></el-pagination>\r\n            </div>\r\n          </div>\r\n        </el-col>\r\n      </el-row>\r\n    </div>\r\n  </div>\r\n</template>\r\n<script>\r\nimport QS from \"qs\";\r\n\r\nexport default {\r\n  data() {\r\n    return {\r\n      searchText: \"\",\r\n      sortby: \"1\",\r\n      searchType: \"1\",\r\n      searchCounts: {\r\n        survey: 0,\r\n        quest: 0,\r\n        tag: 0\r\n      },\r\n      search: [],\r\n      pageinfo: {\r\n        //每页数量\r\n        pageSize: 10,\r\n        //当前页\r\n        currentPage: 1,\r\n        //总数量\r\n        total: 0\r\n      }\r\n    };\r\n  },\r\n\r\n  methods: {\r\n    selectSortBy() {\r\n      this.$router.push({\r\n        query: {\r\n          searchText: this.searchText,\r\n          page: 1,\r\n          sortby: this.sortby\r\n        }\r\n      });\r\n      this.pageinfo.currentPage = 1;\r\n      this.searchPageQuery();\r\n    },\r\n\r\n    chooseSearchType(type) {\r\n      this.searchType = type;\r\n    },\r\n\r\n    searchResultCount() {\r\n      if (this.searchText.length == 0) return;\r\n      const data = {};\r\n      data.searchText = this.searchText;\r\n      this.$http.post(\"search/count\", QS.stringify(data)).then(res => {\r\n        this.searchCounts = res.data;\r\n        this.pageinfo.total = this.searchCounts.survey;\r\n      });\r\n    },\r\n\r\n    searchPageQuery() {\r\n      const data = {};\r\n      data.searchText = this.searchText;\r\n      data.page = this.pageinfo.currentPage;\r\n      data.size = this.pageinfo.pageSize;\r\n      let URL = \"\";\r\n      switch (this.sortby) {\r\n        case \"1\":\r\n          URL = \"search/serveylist/date\";\r\n          break;\r\n        case \"2\":\r\n          URL = \"search/serveylist/quote\";\r\n          break;\r\n        case \"3\":\r\n          URL = \"search/serveylist/visits\";\r\n          break;\r\n        default:\r\n          break;\r\n      }\r\n      this.$http.post(URL, QS.stringify(data)).then(res => {\r\n        this.search = res.data;\r\n        for (const key in this.search) {\r\n          if(this.search[key].tags) this.search[key].tags = this.search[key].tags.split(\",\");\r\n        }\r\n        this.$refs.search.scrollTop = 0;\r\n      });\r\n    },\r\n\r\n    searchCurrentChange(page) {\r\n      this.$router.push({\r\n        query: {\r\n          searchText: this.searchText,\r\n          page: page,\r\n          sortby: this.sortby\r\n        }\r\n      });\r\n      this.pageinfo.currentPage = page;\r\n      this.searchPageQuery();\r\n    },\r\n\r\n    preview(surveyId) {\r\n      this.$router.push({\r\n        name: \"PCView\",\r\n        query: {\r\n          surveyId: surveyId,\r\n          isPreview: true,\r\n          isTemplate: true,\r\n          searchText: this.searchText,\r\n          page: this.pageinfo.currentPage,\r\n          sortby: this.sortby\r\n        }\r\n      });\r\n    }\r\n  },\r\n\r\n  mounted() {\r\n    this.searchText = this.$route.query.searchText;\r\n    this.pageinfo.currentPage = Number(this.$route.query.page);\r\n    this.sortby = this.$route.query.sortby;\r\n    this.searchResultCount();\r\n    this.searchPageQuery();\r\n  }\r\n};\r\n</script>\r\n<style scoped>\r\n.search {\r\n  position: fixed;\r\n  top: 60px;\r\n  left: 0px;\r\n  bottom: 0px;\r\n  right: 0px;\r\n  width: 100%;\r\n  height: calc(100%-60px);\r\n  overflow-y: scroll;\r\n}\r\n/* 查询类型菜单 start */\r\n.menu {\r\n  height: 120px;\r\n}\r\n.menu ul {\r\n  border-right: none;\r\n}\r\n.menu ul li {\r\n  border: 1px solid #eee;\r\n}\r\n/* .menu ul li:nth-child(1) {\r\n  border-bottom: none;\r\n}\r\n.menu ul li:nth-child(2) {\r\n  border-bottom: none;\r\n} */\r\n.menu ul li a {\r\n  color: #0366d6;\r\n}\r\n.menu .el-tag {\r\n  border-radius: 10px;\r\n}\r\n.currentNav {\r\n  border-left: 2px solid #e36209 !important;\r\n}\r\n/* 查询类型菜单 end */\r\n/* 查询结果内容 start */\r\n.result-contain {\r\n  padding-bottom: 60px;\r\n}\r\n.detail h3 {\r\n  color: #24292e;\r\n  height: 40px;\r\n  line-height: 40px;\r\n  margin-top: 0;\r\n}\r\n.detail .el-select {\r\n  float: right;\r\n  width: 150px;\r\n}\r\n.pagination {\r\n  text-align: center;\r\n  margin: 10px 0;\r\n}\r\n/* 查询结果内容 start */\r\n/* 查询条目 start */\r\n.search-result-item {\r\n  padding: 24px 0;\r\n  border-top: 1px solid #e1e4e8;\r\n}\r\n.search-result-item .item-icon {\r\n  margin-top: 2px;\r\n  margin-right: 10px;\r\n  float: left;\r\n}\r\n.search-result-item .item-text {\r\n  display: inline-block;\r\n  width: 675px;\r\n}\r\n.search-result-item .title a {\r\n  color: #0366d6;\r\n  font-size: 16px;\r\n}\r\n.el-link.is-underline:hover:after {\r\n  border-bottom: 2px solid #0366d6;\r\n}\r\n.search-result-item .intro p {\r\n  margin: 6px 0 2px 0;\r\n  font-size: 14px;\r\n}\r\n.search-result-item .tags {\r\n  margin: 6px 0 8px 0;\r\n}\r\n.search-result-item .tags span {\r\n  margin-right: 5px;\r\n}\r\n.search-result-item .info a {\r\n  margin-right: 16px;\r\n}\r\n.search-result-item .info .update-date {\r\n  color: #606266;\r\n  font-size: 14px;\r\n}\r\n/* 查询条目 end */\r\n/* 滚动条样式 start */\r\n.search::-webkit-scrollbar {\r\n  width: 10px;\r\n}\r\n.search::-webkit-scrollbar-thumb {\r\n  background-color: rgba(0, 0, 0, 0.15);\r\n  border-radius: 5px;\r\n}\r\n.search::-webkit-scrollbar-thumb:hover {\r\n  background-color: rgba(0, 0, 0, 0.2);\r\n}\r\n/* 滚动条样式 end */\r\n</style>"]}]}