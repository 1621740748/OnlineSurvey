{"remainingRequest":"/data/OnlineSurvey/FrontEnd/surveyui/node_modules/vue-loader/lib/index.js??vue-loader-options!/data/OnlineSurvey/FrontEnd/surveyui/src/views/home/design/Publish.vue?vue&type=script&lang=js&","dependencies":[{"path":"/data/OnlineSurvey/FrontEnd/surveyui/src/views/home/design/Publish.vue","mtime":1605753490110},{"path":"/data/OnlineSurvey/FrontEnd/surveyui/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/data/OnlineSurvey/FrontEnd/surveyui/node_modules/thread-loader/dist/cjs.js","mtime":499162500000},{"path":"/data/OnlineSurvey/FrontEnd/surveyui/node_modules/babel-loader/lib/index.js","mtime":315532800000},{"path":"/data/OnlineSurvey/FrontEnd/surveyui/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/data/OnlineSurvey/FrontEnd/surveyui/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KDQppbXBvcnQgUVMgZnJvbSAicXMiOw0KDQpleHBvcnQgZGVmYXVsdCB7DQogIGRhdGEoKSB7DQogICAgcmV0dXJuIHsNCiAgICAgIHN1cnZleUlkOiAiIiwNCiAgICAgIHN1cnZleVVybDogIiIsDQogICAgICBtc2c6ICIiLA0KICAgICAgaW1hZ2VRUkNvZGU6ICIiLA0KICAgICAgZW5kRGF0ZVNldHRpbmc6IDAsDQogICAgICBlbkFuRGF0ZTogbnVsbCwNCiAgICAgIHdlY2hhdERpYWxvZ1Zpc2libGU6IGZhbHNlDQogICAgfTsNCiAgfSwNCg0KICBtZXRob2RzOiB7DQogICAgLyoqDQogICAgICog5paw5qCH562+6aG15omT5byA6Zeu5Y23DQogICAgICovDQogICAgb3BlblN1cnZleSgpIHsNCiAgICAgIHdpbmRvdy5vcGVuKHRoaXMuc3VydmV5VXJsKTsNCiAgICB9LA0KICAgIC8qKg0KICAgICAqIOWkjeWItumXruWNt+mTvuaOpQ0KICAgICAqLw0KICAgIGNvcHlMaW5rKCkgew0KICAgICAgdGhpcy4kcmVmcy5pbnB1dC5zZWxlY3QoKTsNCiAgICAgIGlmIChkb2N1bWVudC5leGVjQ29tbWFuZCgiY29weSIpKSB7DQogICAgICAgIHRoaXMuJG1lc3NhZ2Uoew0KICAgICAgICAgIG1lc3NhZ2U6ICc8c3Ryb25nIHN0eWxlPSJjb2xvcjojMzMzIj7lpI3liLbmiJDlip88L3N0cm9uZz4nLA0KICAgICAgICAgIGRhbmdlcm91c2x5VXNlSFRNTFN0cmluZzogdHJ1ZSwNCiAgICAgICAgICBpY29uQ2xhc3M6ICIgIiwNCiAgICAgICAgICBjZW50ZXI6IHRydWUsDQogICAgICAgICAgZHVyYXRpb246IDEwMDAsDQogICAgICAgICAgb2Zmc2V0OiA2OCwNCiAgICAgICAgICBjdXN0b21DbGFzczogImNlbnRlci1tc2dib3giDQogICAgICAgIH0pOw0KICAgICAgfSBlbHNlIHsNCiAgICAgICAgdGhpcy4kbWVzc2FnZSh7DQogICAgICAgICAgbWVzc2FnZTogJzxzdHJvbmcgc3R5bGU9ImNvbG9yOiMzMzMiPuWkjeWItuWksei0pTwvc3Ryb25nPicsDQogICAgICAgICAgZGFuZ2Vyb3VzbHlVc2VIVE1MU3RyaW5nOiB0cnVlLA0KICAgICAgICAgIGljb25DbGFzczogIiAiLA0KICAgICAgICAgIGNlbnRlcjogdHJ1ZSwNCiAgICAgICAgICBkdXJhdGlvbjogMTAwMCwNCiAgICAgICAgICBvZmZzZXQ6IDY4LA0KICAgICAgICAgIGN1c3RvbUNsYXNzOiAiY2VudGVyLW1zZ2JveCINCiAgICAgICAgfSk7DQogICAgICB9DQogICAgfSwNCiAgICAvKioNCiAgICAgKiDojrflj5bpl67ljbfkuoznu7TnoIENCiAgICAgKi8NCiAgICBnZXRTdXJ2ZXlRUkNvZGUoKSB7DQogICAgICBjb25zdCBkYXRhID0ge307DQogICAgICBkYXRhLnN1cnZleVVybCA9IHRoaXMuc3VydmV5VXJsICsgIiZxcmNvZGU9dHJ1ZSI7DQogICAgICB0aGlzLiRodHRwLnBvc3QoInB1Ymxpc2gvZ2V0UVJDb2RlIiwgUVMuc3RyaW5naWZ5KGRhdGEpKS50aGVuKHJlcyA9PiB7DQogICAgICAgIHRoaXMuaW1hZ2VRUkNvZGUgPSByZXMuZGF0YTsNCiAgICAgIH0pOw0KICAgIH0sDQogICAgLyoqDQogICAgICog6K6+5a6a6Zeu5Y2357uT5p2f5pe26Ze0DQogICAgICovDQogICAgc2V0RW5kQW5zd2VyRGF0ZSgpIHsNCiAgICAgIGNvbnN0IHN1cnZleSA9IHt9Ow0KICAgICAgc3VydmV5LmlkID0gdGhpcy5zdXJ2ZXlJZDsNCiAgICAgIHN1cnZleS5lbkhhbmRsZSA9IHRoaXMuZW5kRGF0ZVNldHRpbmc7DQogICAgICBpZiAodGhpcy5lbmREYXRlU2V0dGluZyA9PSAxKSB7DQogICAgICAgIGlmICh0aGlzLmVuQW5EYXRlID09IG51bGwpIHJldHVybjsNCiAgICAgICAgc3VydmV5LmVuQW5EYXRlID0gbmV3IERhdGUodGhpcy5lbkFuRGF0ZSkuZm9ybWF0KCJ5eXl5LU1NLWRkIGhoOm1tOnNzIik7DQogICAgICB9DQogICAgICB0aGlzLiRodHRwLnBvc3QoInNhdmUvc3VydmV5L2luZm8iLCBzdXJ2ZXkpLnRoZW4oKCkgPT4gew0KICAgICAgICB0aGlzLiRtZXNzYWdlKHsNCiAgICAgICAgICBtZXNzYWdlOiAnPHN0cm9uZyBzdHlsZT0iY29sb3I6IzMzMyI+6K6+572u5bey55Sf5pWIPC9zdHJvbmc+JywNCiAgICAgICAgICBkYW5nZXJvdXNseVVzZUhUTUxTdHJpbmc6IHRydWUsDQogICAgICAgICAgaWNvbkNsYXNzOiAiICIsDQogICAgICAgICAgY2VudGVyOiB0cnVlLA0KICAgICAgICAgIGR1cmF0aW9uOiAxMDAwLA0KICAgICAgICAgIG9mZnNldDogNjgsDQogICAgICAgICAgY3VzdG9tQ2xhc3M6ICJjZW50ZXItbXNnYm94Ig0KICAgICAgICB9KTsNCiAgICAgIH0pOw0KICAgIH0sDQogICAgLyoqDQogICAgICog6I635Y+W6Zeu5Y235L+h5oGv77yI5p+l55yL6Zeu5Y2357uT5p2f5pe26Ze055qE6K6+572u77yJDQogICAgICovDQogICAgZ2V0U3VydmV5U3RhdHVzKCkgew0KICAgICAgdGhpcy4kaHR0cC5nZXQoYHN1cnZleS9zdGF0dXMvJHt0aGlzLnN1cnZleUlkfWApLnRoZW4ocmVzID0+IHsNCiAgICAgICAgdGhpcy5lbmREYXRlU2V0dGluZyA9IHJlcy5kYXRhLmVuSGFuZGxlOw0KICAgICAgICB0aGlzLmVuQW5EYXRlID0gcmVzLmRhdGEuZW5BbkRhdGU7DQogICAgICB9KTsNCiAgICB9DQogIH0sDQoNCiAgbW91bnRlZCgpIHsNCiAgICB0aGlzLnN1cnZleUlkID0gdGhpcy4kcm91dGUucXVlcnkuc3VydmV5SWQ7DQogICAgdGhpcy5zdXJ2ZXlVcmwgPSBgJHt0aGlzLiRodHRwLmRvbWFpbn0vIy9hbnN3ZXIvcGMvP3N1cnZleUlkPSR7dGhpcy5zdXJ2ZXlJZH1gOw0KICAgIHRoaXMuZ2V0U3VydmV5UVJDb2RlKCk7DQogICAgdGhpcy5nZXRTdXJ2ZXlTdGF0dXMoKTsNCiAgfQ0KfTsNCg=="},{"version":3,"sources":["Publish.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA4FA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA","file":"Publish.vue","sourceRoot":"src/views/home/design","sourcesContent":["<template>\r\n  <div class=\"publish\">\r\n    <div class=\"card\">\r\n      <el-row :gutter=\"10\">\r\n        <el-col :span=\"16\">\r\n          <el-card style=\"margin-bottom:10px;\">\r\n            <div class=\"share-card\">\r\n              <h3>问卷链接</h3>\r\n              <el-row :gutter=\"20\">\r\n                <el-col :span=\"5\">\r\n                  <div class=\"qrcode\" style=\"width:106.2px;height:106.2px;background:#333;\">\r\n                    <el-image\r\n                      style=\"width: 106.2px; height: 106.2px\"\r\n                      :src=\"imageQRCode\"\r\n                      fit=\"cover\"\r\n                    ></el-image>\r\n                  </div>\r\n                </el-col>\r\n                <el-col :span=\"16\">\r\n                  <div class=\"copy-text-input\">\r\n                    <el-input v-model=\"surveyUrl\" style=\"margin-bottom: 25px;\" ref=\"input\">\r\n                      <el-button slot=\"append\" class=\"btn\" @click=\"copyLink()\">复制</el-button>\r\n                    </el-input>\r\n                    <el-link\r\n                      :underline=\"false\"\r\n                      :href=\"imageQRCode\"\r\n                      download=\"qrcode.png\"\r\n                      style=\"margin-right:20px\"\r\n                    >\r\n                      <el-button plain>下载二维码</el-button>\r\n                    </el-link>\r\n                    <el-button plain @click=\"wechatDialogVisible = true\">分享到微信朋友圈</el-button>\r\n                  </div>\r\n                </el-col>\r\n                <el-col :span=\"3\">\r\n                  <el-button class=\"button\" plain @click=\"openSurvey()\">打开</el-button>\r\n                </el-col>\r\n              </el-row>\r\n            </div>\r\n          </el-card>\r\n          <el-card style=\"height:329px\">\r\n            <div class=\"setting-card\">\r\n              <h3>回收设置</h3>\r\n              <el-switch\r\n                v-model=\"endDateSetting\"\r\n                active-text=\"设定问卷结束时间\"\r\n                :active-value=\"1\"\r\n                :inactive-value=\"0\"\r\n                @change=\"setEndAnswerDate\"\r\n              ></el-switch>\r\n              <p v-show=\"endDateSetting\">\r\n                <el-date-picker\r\n                  v-model=\"enAnDate\"\r\n                  type=\"datetime\"\r\n                  placeholder=\"选择日期时间\"\r\n                  @change=\"setEndAnswerDate\"\r\n                ></el-date-picker>\r\n              </p>\r\n            </div>\r\n          </el-card>\r\n        </el-col>\r\n        <el-col :span=\"8\">\r\n          <el-card class=\"preview-card\">\r\n            <div class=\"mobile-preview\">\r\n              <iframe id=\"preview_mobile_iframe\" :src=\"surveyUrl+'&noAddVisits=true'\" frameborder=\"0\"></iframe>\r\n            </div>\r\n          </el-card>\r\n        </el-col>\r\n      </el-row>\r\n    </div>\r\n    <!-- 微信扫码分享问卷 -->\r\n    <el-dialog\r\n      title=\"扫码分享问卷\"\r\n      width=\"580px\"\r\n      :visible.sync=\"wechatDialogVisible\"\r\n      :close-on-click-modal=\"false\"\r\n      :close-on-press-escape=\"false\"\r\n      :show-close=\"false\"\r\n      append-to-body\r\n    >\r\n      <div style=\"text-align:center\">\r\n        <p>微信扫一扫二维码，点击右上角分享该问卷</p>\r\n        <el-image style=\"width: 200px; height: 200px\" :src=\"imageQRCode\" fit=\"cover\"></el-image>\r\n      </div>\r\n      <div slot=\"footer\">\r\n        <el-button type=\"primary\" @click=\"wechatDialogVisible = false\">关闭</el-button>\r\n      </div>\r\n    </el-dialog>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport QS from \"qs\";\r\n\r\nexport default {\r\n  data() {\r\n    return {\r\n      surveyId: \"\",\r\n      surveyUrl: \"\",\r\n      msg: \"\",\r\n      imageQRCode: \"\",\r\n      endDateSetting: 0,\r\n      enAnDate: null,\r\n      wechatDialogVisible: false\r\n    };\r\n  },\r\n\r\n  methods: {\r\n    /**\r\n     * 新标签页打开问卷\r\n     */\r\n    openSurvey() {\r\n      window.open(this.surveyUrl);\r\n    },\r\n    /**\r\n     * 复制问卷链接\r\n     */\r\n    copyLink() {\r\n      this.$refs.input.select();\r\n      if (document.execCommand(\"copy\")) {\r\n        this.$message({\r\n          message: '<strong style=\"color:#333\">复制成功</strong>',\r\n          dangerouslyUseHTMLString: true,\r\n          iconClass: \" \",\r\n          center: true,\r\n          duration: 1000,\r\n          offset: 68,\r\n          customClass: \"center-msgbox\"\r\n        });\r\n      } else {\r\n        this.$message({\r\n          message: '<strong style=\"color:#333\">复制失败</strong>',\r\n          dangerouslyUseHTMLString: true,\r\n          iconClass: \" \",\r\n          center: true,\r\n          duration: 1000,\r\n          offset: 68,\r\n          customClass: \"center-msgbox\"\r\n        });\r\n      }\r\n    },\r\n    /**\r\n     * 获取问卷二维码\r\n     */\r\n    getSurveyQRCode() {\r\n      const data = {};\r\n      data.surveyUrl = this.surveyUrl + \"&qrcode=true\";\r\n      this.$http.post(\"publish/getQRCode\", QS.stringify(data)).then(res => {\r\n        this.imageQRCode = res.data;\r\n      });\r\n    },\r\n    /**\r\n     * 设定问卷结束时间\r\n     */\r\n    setEndAnswerDate() {\r\n      const survey = {};\r\n      survey.id = this.surveyId;\r\n      survey.enHandle = this.endDateSetting;\r\n      if (this.endDateSetting == 1) {\r\n        if (this.enAnDate == null) return;\r\n        survey.enAnDate = new Date(this.enAnDate).format(\"yyyy-MM-dd hh:mm:ss\");\r\n      }\r\n      this.$http.post(\"save/survey/info\", survey).then(() => {\r\n        this.$message({\r\n          message: '<strong style=\"color:#333\">设置已生效</strong>',\r\n          dangerouslyUseHTMLString: true,\r\n          iconClass: \" \",\r\n          center: true,\r\n          duration: 1000,\r\n          offset: 68,\r\n          customClass: \"center-msgbox\"\r\n        });\r\n      });\r\n    },\r\n    /**\r\n     * 获取问卷信息（查看问卷结束时间的设置）\r\n     */\r\n    getSurveyStatus() {\r\n      this.$http.get(`survey/status/${this.surveyId}`).then(res => {\r\n        this.endDateSetting = res.data.enHandle;\r\n        this.enAnDate = res.data.enAnDate;\r\n      });\r\n    }\r\n  },\r\n\r\n  mounted() {\r\n    this.surveyId = this.$route.query.surveyId;\r\n    this.surveyUrl = `${this.$http.domain}/#/answer/pc/?surveyId=${this.surveyId}`;\r\n    this.getSurveyQRCode();\r\n    this.getSurveyStatus();\r\n  }\r\n};\r\n</script>\r\n\r\n<style scoped>\r\n.publish {\r\n  position: fixed;\r\n  top: 122px;\r\n  left: 0;\r\n  right: 0;\r\n  bottom: 0;\r\n  overflow-x: auto;\r\n  overflow-y: scroll;\r\n  background-color: #f4f6f9;\r\n}\r\n.card {\r\n  width: 1100px;\r\n  height: 100%;\r\n  margin: 20px auto;\r\n}\r\n.share-card,\r\n.setting-card {\r\n  padding: 30px 20px;\r\n}\r\nh3 {\r\n  margin-top: 0;\r\n}\r\n/* .preview-card {\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: center;\r\n} */\r\n.mobile-preview {\r\n  height: 550px;\r\n  background-size: contain;\r\n  background-repeat: no-repeat;\r\n  background-image: url(\"~@/assets/image/bg_perview_mobile_no_shadow.png\");\r\n  /* display: flex;\r\n  align-items: center;\r\n  justify-content: center; */\r\n}\r\n#preview_mobile_iframe {\r\n  position: absolute;\r\n  /* width: 312px; */\r\n  width: 203px;\r\n  height: 362px;\r\n  margin-top: 83px;\r\n  margin-left: 55px;\r\n  /* top: 87px;\r\n  left: 19px; */\r\n}\r\n/* 滚动条样式 start */\r\n.publish::-webkit-scrollbar {\r\n  width: 10px;\r\n}\r\n.publish::-webkit-scrollbar-thumb {\r\n  background-color: rgba(0, 0, 0, 0.15);\r\n  border-radius: 5px;\r\n}\r\n.publish::-webkit-scrollbar-thumb:hover {\r\n  background-color: rgba(0, 0, 0, 0.2);\r\n}\r\n/* 滚动条样式 end */\r\n</style>"]}]}